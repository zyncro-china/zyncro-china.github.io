<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge;chrome=1' http-equiv='X-UA-Compatible'>
<title>prawnpdf</title>
<meta content='' name='description'>
<meta content='width=device-width' name='viewport'>
<link href='/css/normalize.css' rel='stylesheet'>
<link href='/css/main.css' rel='stylesheet'>
<link href='/css/bootstrap.min.css' rel='stylesheet'>
<link href='/stylesheets/background.css' rel='stylesheet'>
<link href='/stylesheets/article.css' rel='stylesheet'>
<script src='/js/vendor/modernizr-2.6.1.min.js'></script>
<script src='/js/vendor/jquery-1.8.0.min.js'></script>
<script src='/js/bootstrap.min.js'></script>
<link href="/stylesheets/rouge.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/home.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
<header>
<nav class='navbar navbar-default' role='navigation'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-ex1-collapse' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand'></a>
</div>
<div class='collapse navbar-collapse navbar-ex1-collapse'>
<ul class='nav navbar-nav'>
<li>
<a href='/'>Home</a>
</li>
<li>
<a href='/feed.xml'>Feed</a>
</li>
<li>
<a href='/about'>About</a>
</li>
</ul>
</div>
</nav>
</header>
<section class='main'>
<div id='main' role='main'>
<div class='container'>
<article>
<div class='title'>
<h1 class='page-header text-center'>
prawnpdf
</h1>
</div>
<br>
<h2>Prawn</h2>

<p>Prawn是用于生成pdf的ruby库。了解它的使用方法它的最快途径是看它的manual</p>

<h2>Manual的内容</h2>

<ol>
<li>Basic concepts</li>
<li>Graphics</li>
<li>Text</li>
<li>Bounding box</li>
<li>Layout</li>
<li>Table</li>
<li>Images</li>
<li>Documents and page options</li>
<li>Outline</li>
<li>Repeatable content</li>
<li>Security</li>
</ol>

<h3>Basic Concepts</h3>

<p>这部分包括</p>

<ol>
<li>Creation</li>
<li>Origin</li>
<li>Cursor</li>
<li>Other cursor helper</li>
<li>Adding pages</li>
<li>Measurement</li>
<li>View</li>
</ol>

<h4>Creation</h4>

<p>有3种方式</p>
<pre class="highlight ruby"><span class="c1"># Assignment</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="nf">.new</span>
<span class="n">pdf</span><span class="nf">.text</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="n">pdf</span><span class="nf">.render_file</span> <span class="s2">&quot;assignment.pdf&quot;</span>
<span class="c1"># Implicit Block</span>
<span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="nf">.generate</span><span class="p">(</span><span class="s2">&quot;implicit.pdf&quot;</span><span class="p">)</span> <span class="k">do</span>
<span class="n">text</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="k">end</span>
<span class="c1"># Explicit Block</span>
<span class="no">Prawn</span><span class="o">::</span><span class="no">Document</span><span class="nf">.generate</span><span class="p">(</span><span class="s2">&quot;explicit.pdf&quot;</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">pdf</span><span class="o">|</span>
<span class="n">pdf</span><span class="nf">.text</span> <span class="s2">&quot;Hello World&quot;</span>
<span class="k">end</span>
</pre>
<h4>Origin</h4>

<ol>
<li>document的坐标起点[0,0]是左下角</li>
<li>bouncing box是用于插入内容的边框,注意它位置的坐标是位于它的左上角</li>
<li>每个文档都至少有一个bouncing box,就是margin box</li>
</ol>

<p>下面代码画出文档坐标，bouncing box边框，以及在两个原点画圈</p>
<pre class="highlight ruby"><span class="n">stroke_axis</span>
<span class="n">stroke_circle</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="mi">10</span>
<span class="n">bounding_box</span><span class="p">(</span><span class="o">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="o">]</span><span class="p">,</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">300</span><span class="p">,</span> <span class="ss">:height</span> <span class="o">=&gt;</span> <span class="mi">200</span><span class="p">)</span> <span class="k">do</span>
  <span class="n">stroke_bounds</span>
  <span class="n">stroke_circle</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="o">]</span><span class="p">,</span> <span class="mi">10</span>
<span class="k">end</span>

</pre>
<h4>Cursor</h4>

<p>Cursor指定插入内容的位置，从文档的左上角开始往下</p>
<pre class="highlight ruby"><span class="n">stroke_axis</span>

<span class="n">text</span> <span class="s2">&quot;the cursor is here: </span><span class="si">#{</span><span class="n">cursor</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">text</span> <span class="s2">&quot;now it is here: </span><span class="si">#{</span><span class="n">cursor</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">move_down</span> <span class="mi">200</span>
<span class="n">text</span> <span class="s2">&quot;on the first move the cursor went down to: </span><span class="si">#{</span><span class="n">cursor</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">move_up</span> <span class="mi">100</span>
<span class="n">text</span> <span class="s2">&quot;on the second move the cursor went up to: </span><span class="si">#{</span><span class="n">cursor</span><span class="si">}</span><span class="s2">&quot;</span>

<span class="n">move_cursor_to</span> <span class="mi">50</span>
<span class="n">text</span> <span class="s2">&quot;on the last move the cursor went directly to: </span><span class="si">#{</span><span class="n">cursor</span><span class="si">}</span><span class="s2">&quot;</span>
</pre>
<h4>其他 Cursor Helper</h4>

<p>pad和css里的padding相似
float在显示内容后把cursor恢复之前位置</p>
<pre class="highlight ruby">
<span class="n">stroke_horizontal_rule</span>
<span class="n">pad</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span> <span class="n">text</span> <span class="s2">&quot;Text padded both before and after.&quot;</span> <span class="p">}</span>

<span class="n">stroke_horizontal_rule</span>
<span class="n">pad_top</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span> <span class="n">text</span> <span class="s2">&quot;Text padded on the top.&quot;</span> <span class="p">}</span>

<span class="n">stroke_horizontal_rule</span>
<span class="n">pad_bottom</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span> <span class="p">{</span> <span class="n">text</span> <span class="s2">&quot;Text padded on the bottom.&quot;</span> <span class="p">}</span>

<span class="n">stroke_horizontal_rule</span>
<span class="n">move_down</span> <span class="mi">30</span>

<span class="n">text</span> <span class="s2">&quot;Text written before the float block.&quot;</span>

<span class="n">float</span> <span class="k">do</span>
  <span class="n">move_down</span> <span class="mi">30</span>
  <span class="n">bounding_box</span><span class="p">(</span><span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">cursor</span><span class="o">]</span><span class="p">,</span> <span class="ss">:width</span> <span class="o">=&gt;</span> <span class="mi">200</span><span class="p">)</span> <span class="k">do</span>
    <span class="n">text</span> <span class="s2">&quot;Text written inside the float block.&quot;</span>
    <span class="n">stroke_bounds</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">text</span> <span class="s2">&quot;Text written after the float block.&quot;</span>

</pre>
<h4>Adding new page</h4>
<pre class="highlight ruby"><span class="n">text</span> <span class="s2">&quot;We are still on the initial page for this example. Now I&#39;ll ask &quot;</span> <span class="o">+</span>
<span class="s2">&quot;Prawn to gently start a new page. Please follow me to the next page.&quot;</span>

<span class="n">start_new_page</span>

<span class="n">text</span> <span class="s2">&quot;See. We&#39;ve left the previous page behind.&quot;</span>
</pre>
<h4>Measurement</h4>

<p>Prawn里基本单位是point，每个point是1/72英寸
只需要 require &ldquo;prawn/measurement_extensions&rdquo;, Numeric类就具有那些helper方法</p>
<pre class="highlight ruby"><span class="nb">require</span> <span class="s2">&quot;prawn/measurement_extensions&quot;</span>
<span class="o">[</span><span class="ss">:mm</span><span class="p">,</span> <span class="ss">:cm</span><span class="p">,</span> <span class="ss">:dm</span><span class="p">,</span> <span class="ss">:m</span><span class="p">,</span> <span class="ss">:in</span><span class="p">,</span> <span class="ss">:yd</span><span class="p">,</span> <span class="ss">:ft</span><span class="o">]</span><span class="nf">.each</span> <span class="k">do</span> <span class="o">|</span><span class="n">measurement</span><span class="o">|</span>
<span class="n">text</span> <span class="s2">&quot;1 </span><span class="si">#{</span><span class="n">measurement</span><span class="si">}</span><span class="s2"> in PDF Points: </span><span class="si">#{</span><span class="mi">1</span><span class="nf">.send</span><span class="p">(</span><span class="n">measurement</span><span class="p">)</span><span class="si">}</span><span class="s2"> pt&quot;</span>
<span class="n">move_down</span> <span class="mi">5</span><span class="nf">.mm</span>
<span class="k">end</span>
</pre>
<p>输出</p>
<pre class="highlight shell">1 mm <span class="k">in </span>PDF Points: 2.834645669291339 pt
1 cm <span class="k">in </span>PDF Points: 28.34645669291339 pt
1 dm <span class="k">in </span>PDF Points: 283.46456692913387 pt
1 m <span class="k">in </span>PDF Points: 2834.645669291339 pt
1 <span class="k">in in </span>PDF Points: 72 pt
1 yd <span class="k">in </span>PDF Points: 2592 pt
1 ft <span class="k">in </span>PDF Points: 864 pt
</pre>
<h4>view</h4>

<p>当要使用自定义的类，应该用mixin。
也可以定义一个document()方法，返回一个符合Prawn::Document
protocol的对象，所有方法会代理到那个对象。</p>
<pre class="highlight ruby">
<span class="k">class </span><span class="nc">Greeter</span>
  <span class="kp">include</span> <span class="no">Prawn</span><span class="o">::</span><span class="no">View</span>
  <span class="k">def </span><span class="nf">initialize</span><span class="p">(</span><span class="nb">name</span><span class="p">)</span>
    <span class="vi">@name</span> <span class="o">=</span> <span class="nb">name</span>
  <span class="k">end</span>
  <span class="k">def </span><span class="nf">say_hello</span>
    <span class="n">text</span> <span class="s2">&quot;Hello, </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">!&quot;</span>
  <span class="k">end</span>
  <span class="k">def </span><span class="nf">say_goodbye</span>
    <span class="n">font</span><span class="p">(</span><span class="s2">&quot;Courier&quot;</span><span class="p">)</span> <span class="k">do</span>
      <span class="n">text</span> <span class="s2">&quot;Goodbye, </span><span class="si">#{</span><span class="vi">@name</span><span class="si">}</span><span class="s2">!&quot;</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="n">greeter</span> <span class="o">=</span> <span class="no">Greeter</span><span class="nf">.new</span><span class="p">(</span><span class="s2">&quot;Gregory&quot;</span><span class="p">)</span>
<span class="n">greeter</span><span class="nf">.say_hello</span>
<span class="n">greeter</span><span class="nf">.say_goodbye</span>
<span class="n">greeter</span><span class="nf">.save_as</span><span class="p">(</span><span class="s2">&quot;greetings.pdf&quot;</span><span class="p">)</span>

</pre>
<h3>Graphics</h3>

<ol>
<li>Basics</li>
<li>Shapes</li>
<li>Fill and Stroke settings</li>
<li>Transformations</li>
</ol>

<h4>Basics</h4>

<ol>
<li>helpers: stroke_axis</li>
<li>fill and stroke</li>
</ol>

<p>fill 和 stroke是最终画出图形的方法，其他的方法只是定义了drawing path，例如 rectangle, circle or line_to</p>
<pre class="highlight ruby">
<span class="n">stroke_axis</span>

<span class="c1"># No block</span>
<span class="n">line</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">150</span><span class="o">]</span>
<span class="n">stroke</span>

<span class="n">rectangle</span> <span class="o">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>
<span class="n">fill</span>

<span class="c1"># With block</span>
<span class="n">stroke</span> <span class="p">{</span> <span class="n">line</span> <span class="o">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">150</span><span class="o">]</span> <span class="p">}</span>
<span class="n">fill</span> <span class="p">{</span> <span class="n">rectangle</span> <span class="o">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span> <span class="p">}</span>

<span class="c1"># Method hook</span>
<span class="n">stroke_line</span> <span class="o">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">200</span><span class="o">]</span><span class="p">,</span> <span class="o">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">150</span><span class="o">]</span>
<span class="n">fill_rectangle</span> <span class="o">[</span><span class="mi">400</span><span class="p">,</span> <span class="mi">100</span><span class="o">]</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span>

</pre>
<h4>Shapes</h4>

<h4>Filling and Stroke Setting</h4>

<p>注意，由于Ruby认为=左边的是局部变量，而不是函数调用，当设置line_width时，需要加上self</p>

</article>
<div id="disqus_thread"></div>
            <script type="text/javascript">
            //<![CDATA[
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//zyncrochinadevblog.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            //]]>
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </script>

</div>
</div>
</section>
<footer>
<script type="text/javascript">
//<![CDATA[
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44086232-1', 'zyncro-china.com');
  ga('send', 'pageview');
//]]>
</script>
</footer>
</body>
</html>

