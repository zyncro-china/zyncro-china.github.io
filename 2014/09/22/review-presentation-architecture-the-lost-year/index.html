<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge;chrome=1' http-equiv='X-UA-Compatible'>
<title>review presentation architecture the lost year</title>
<meta content='' name='description'>
<meta content='width=device-width' name='viewport'>
<link href='/css/normalize.css' rel='stylesheet'>
<link href='/css/main.css' rel='stylesheet'>
<link href='/css/bootstrap.min.css' rel='stylesheet'>
<link href='/stylesheets/background.css' rel='stylesheet'>
<link href='/stylesheets/article.css' rel='stylesheet'>
<script src='/js/vendor/modernizr-2.6.1.min.js'></script>
<script src='/js/vendor/jquery-1.8.0.min.js'></script>
<script src='/js/bootstrap.min.js'></script>
<link href="/stylesheets/rouge.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/home.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
<header>
<nav class='navbar navbar-default' role='navigation'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-ex1-collapse' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand'></a>
</div>
<div class='collapse navbar-collapse navbar-ex1-collapse'>
<ul class='nav navbar-nav'>
<li>
<a href='/'>Home</a>
</li>
<li>
<a href='/feed.xml'>Feed</a>
</li>
<li>
<a href='/about'>About</a>
</li>
</ul>
</div>
</nav>
</header>
<section class='main'>
<div id='main' role='main'>
<div class='container'>
<article>
<div class='title'>
<h1 class='page-header text-center'>
review presentation architecture the lost year
</h1>
</div>
<br>
<h2>回顾以前看过的一个rubyconf presentation</h2>

<p>再回顾一次2011年的一个presentation， Uncle Bob的 Architecture the lost
years。编程业虽然经常会冒出一些新技术，但有些东西是持久不变的。再回顾一次并记下要点</p>

<h3>Rails项目的目录结构</h3>

<p>每个Rails项目下都是app/controller,
app/models,等等，但是，项目的目录结构应该反映出application的structure，不是使用什么framework。</p>

<p>而且，<em>Web is a delivery mechanism</em>, Web is the detail</p>

<p>建筑图纸为例，我们可以看到建筑物是什么，看到其结构，看到他的intent</p>

<h3>Architecture is about Intent</h3>

<p>为什么要在top level看到intent</p>

<p>1990时代出的一本书，那时还没有web， Object-Oriented Software Engineering,用use
case来解决architecture的问题</p>

<p>什么是use case，形如：</p>
<pre class="highlight text">Create Order

Data:
  &lt;Customer-id&gt;,  &lt;Customer-contact-info&gt;,
  &lt;Shipment-destination&gt;, &lt;Shipment-mechanism&gt;,
  &lt;Payment-information&gt;

Primary Course:
  1. Order clerk issues &quot;Create Order&quot; command with above data
  2. System validates all data.
  3. System creates order and determines order id.
  4. System delivers order id to clerk

Exception Course: Validation Error
  1. System delivers error message to clerk

</pre>
<h3>Interactors</h3>

<p>Interactors实现了use case的logic。</p>

<p>Interactors have: Application specific business rules</p>

<p>什么是 application specific business rules</p>

<h3>Entities</h3>

<p><img alt="screencast" src="/images/lost_years/entities.jpg" /></p>

<p>什么是 application independent business rules</p>

<p>例子：Entity</p>

<p>在rails里，model混合了两者。</p>

<h3>Boundary</h3>

<p><img alt="screencast" src="/images/lost_years/system.jpg" /></p>

<p>有可能是javascript，由于interactor和boundary的连接线的箭头都是指向boundry，所以boundry不依赖于interactor和delivery mechanism, delivery mechanism可以作为一个plugin</p>

<p>这种结构的好处是在application的目录下，可以直接看到不同的interactor名字，反映了use case, 如create order</p>

<h3>What about MVC</h3>

<p>MVC is not an architecture</p>

<p><img alt="screencast" src="/images/lost_years/mvc_wrong.jpg" /></p>

<h3>MVC is a delivery design pattern</h3>

<p><img alt="screencast" src="/images/lost_years/mvc_deliver.jpg" /></p>

<p>Controller只需要生成request model</p>

<h3>Model View Presenter</h3>

<p><img alt="screencast" src="/images/lost_years/model_view_presenter.jpg" /></p>

<p>Presenter生成view model数据结构，view model不知道web</p>

<p>view不需测试</p>

<h3>EHCHILADA</h3>

<p><img alt="screencast" src="/images/lost_years/enchilada.jpg" /></p>

<p>分割线左边和右边都可以独立为一个gem，然后可以plugin他们</p>

<h3>testing slow的后果</h3>

<p>减少测试或不测试</p>

<h3>Database centered solution</h3>

<p><img alt="screencast" src="/images/lost_years/db_centered.jpg" /></p>

<p>Database is a detail,architecture不应该了解如何去存储,只需要知道对象。</p>

<p><img alt="screencast" src="/images/lost_years/entity_gateway.jpg" /></p>

<p>ENTITY GATEWAY是接口，如put，create</p>

<p>Architecture的工作之一是划线</p>

<p>这种架构下，run testing不需要delivery mechanism, 不需要database</p>

<h3>A Good Architecture allows major decisions to be DEFERRED!</h3>

<h3>A Good Architecture MAXIMIZES the decisions not made</h3>

<h3>TDD</h3>

<p>writing tests after the fact is wasting time</p>

<p>why TDD, because you know every line of code comes from a failed test</p>

<p>为了test first，必须test fast, 所以要decouple system</p>

</article>
<div id="disqus_thread"></div>
            <script type="text/javascript">
            //<![CDATA[
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//zyncrochinadevblog.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            //]]>
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </script>

</div>
</div>
</section>
<footer>
<script type="text/javascript">
//<![CDATA[
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44086232-1', 'zyncro-china.com');
  ga('send', 'pageview');
//]]>
</script>
</footer>
</body>
</html>

