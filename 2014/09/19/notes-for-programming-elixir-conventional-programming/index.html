<html>
<head>
<meta charset='utf-8'>
<meta content='IE=edge;chrome=1' http-equiv='X-UA-Compatible'>
<title>notes for programming elixir conventional programming</title>
<meta content='' name='description'>
<meta content='width=device-width' name='viewport'>
<link href='/css/normalize.css' rel='stylesheet'>
<link href='/css/main.css' rel='stylesheet'>
<link href='/css/bootstrap.min.css' rel='stylesheet'>
<link href='/stylesheets/background.css' rel='stylesheet'>
<link href='/stylesheets/article.css' rel='stylesheet'>
<script src='/js/vendor/modernizr-2.6.1.min.js'></script>
<script src='/js/vendor/jquery-1.8.0.min.js'></script>
<script src='/js/bootstrap.min.js'></script>
<link href="/stylesheets/rouge.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/home.css" media="screen" rel="stylesheet" type="text/css" />
</head>
<body>
<header>
<nav class='navbar navbar-default' role='navigation'>
<div class='navbar-header'>
<button class='navbar-toggle' data-target='.navbar-ex1-collapse' data-toggle='collapse' type='button'>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
<span class='icon-bar'></span>
</button>
<a class='navbar-brand'></a>
</div>
<div class='collapse navbar-collapse navbar-ex1-collapse'>
<ul class='nav navbar-nav'>
<li>
<a href='/'>Home</a>
</li>
<li>
<a href='/feed.xml'>Feed</a>
</li>
<li>
<a href='/about'>About</a>
</li>
</ul>
</div>
</nav>
</header>
<section class='main'>
<div id='main' role='main'>
<div class='container'>
<article>
<div class='title'>
<h1 class='page-header text-center'>
notes for programming elixir conventional programming
</h1>
</div>
<br>
<h2>part I conventional programming的内容</h2>

<ol>
<li><a href="#pattern_matching">pattern matching</a></li>
<li><a href="#immutability">Immutability</a></li>
<li><a href="#elixir_basic">Elixir Basic</a></li>
<li><a href="#anonymous_functions">Anonymous Functions</a></li>
<li><a href="#modules_and_named_functions">Modules and Named Functions</a></li>
<li><a href="#lists_and_recursion">Lists and Recursion</a></li>
<li><a href="#maps_hashdicts_keyword_and_sets">Maps, HashDicts, Keyword, and Sets</a></li>
<li><a href="#what_are_types">What are types</a></li>
<li><a href="#processing_collections_enums_and_stream">Processing Collections&ndash;Enums and Stream</a></li>
<li><a href="#string_and_binaries">String and Binaries</a></li>
<li><a href="#control_flow">Control Flow</a></li>
<li><a href="#organizing_a_project">Organizing a Project</a></li>
</ol>

<p><a name="pattern_matching"></a></p>

<h2>pattern matching</h2>

<p>与Erlang里的pattern
match差不多，不过elixir里的变量可以重复绑定不同的值，如果要和erlang一致，需要在变量前面加^</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="m">1</span>
<span class="m">1</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="m">2</span>
<span class="m">2</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="o">^</span><span class="n">a</span> <span class="o">=</span> <span class="m">1</span>
<span class="o">**</span> <span class="p">(</span><span class="no">MatchError</span><span class="p">)</span> <span class="n">no</span> <span class="n">match</span> <span class="n">of</span> <span class="n">right</span> <span class="n">hand</span> <span class="n">side</span> <span class="ss">value:</span> <span class="m">1</span>
</pre>
<p><a name="immutability"></a></p>

<h2>Immutability</h2>

<p>关于mutable语言的问题：</p>

<p>GOTO was evil because we asked, &ldquo;how did I get to this point of execution?&rdquo;
Mutability leaves us with, &ldquo;how did I get to this state&rdquo;</p>

<p>在Elixir里，值是immutable,只有变量可以重新绑定。</p>

<p>为提高性能，Elixir对数据的操作应该在列表头部插入</p>

<p>大部分语言采用GC,但有性能问题。Elixir使用大量的process，每个process有自己的heap，GC较容易，而且当process结束时，可以直接删掉所有数据，不需要GC</p>

<p><a name="elixir_basic"></a></p>

<h2>Elixir Basics</h2>

<p>Elixir有下面built-in types</p>

<ol>
<li>Value types

<ol>
<li>Arbitary-sized integers</li>
<li>Floating point numbers</li>
<li>Atoms</li>
<li>Regular expressions</li>
<li>Ranges</li>
</ol></li>
<li>System types

<ol>
<li>PIDs and Ports</li>
<li>References</li>
</ol></li>
<li>Collection types

<ol>
<li>Tuples</li>
<li>Lists</li>
<li>Maps</li>
<li>Binaries</li>
</ol></li>
</ol>

<p>Functions, Strings, Lists/Maps/Dictionary在单独的章节里讲到。</p>

<h3>Value types</h3>

<ol>
<li>Integers: 1234, 0xcafe, 0765, 0b1010, 1_000_000</li>
<li>Floating point numbers: 1.0 0.2345, 0.3123e1, 313451.0e-5</li>
<li>Atoms: 类似ruby的symbol，:fred, :is_binary?, :&lt;&gt;, :&ldquo;func/3&rdquo;</li>
<li>Ranges: start..end, 3..7</li>
<li>Regular expressions: ~r{regexp}, ~r{regexp}opts</li>
</ol>

<p>可以用Regex module</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Regex</span><span class="o">.</span><span class="n">run</span> <span class="err">~</span><span class="n">r</span><span class="p">{[</span><span class="n">aeiou</span><span class="p">]},</span> <span class="sd">&quot;</span><span class="s2">caterpillar&quot;</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">a&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Regex</span><span class="o">.</span><span class="n">scan</span> <span class="err">~</span><span class="n">r</span><span class="p">{[</span><span class="n">aeiou</span><span class="p">]},</span> <span class="sd">&quot;</span><span class="s2">caterpillar&quot;</span>
<span class="p">[[</span><span class="sd">&quot;</span><span class="s2">a&quot;</span><span class="p">],</span> <span class="p">[</span><span class="sd">&quot;</span><span class="s2">e&quot;</span><span class="p">],</span> <span class="p">[</span><span class="sd">&quot;</span><span class="s2">i&quot;</span><span class="p">],</span> <span class="p">[</span><span class="sd">&quot;</span><span class="s2">a&quot;</span><span class="p">]]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Regex</span><span class="o">.</span><span class="n">split</span> <span class="err">~</span><span class="n">r</span><span class="p">{[</span><span class="n">aeiou</span><span class="p">]},</span> <span class="sd">&quot;</span><span class="s2">caterpillar&quot;</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">c&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">t&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">rp&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">ll&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">r&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Regex</span><span class="o">.</span><span class="n">replace</span> <span class="err">~</span><span class="n">r</span><span class="p">{[</span><span class="n">aeiou</span><span class="p">]},</span> <span class="sd">&quot;</span><span class="s2">caterpillar&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">*&quot;</span>
<span class="sd">&quot;</span><span class="s2">c*t*rp*ll*r&quot;</span>
</pre>
<h3>System Types</h3>

<ol>
<li>Pids and Ports. 获取当前的pid用self, spawn新process时会得到他的pid</li>
<li>References: make_ref会返回一个global的reference</li>
</ol>

<h3>Collection Types</h3>

<ol>
<li>Tuples, 同erlang里的tuples一样</li>
<li>Records, 基于tuples, 是用来命名tuples里的fields</li>
</ol>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="k">defrecord</span> <span class="no">Phone</span><span class="p">,</span> <span class="ss">country:</span> <span class="sd">&quot;</span><span class="s2">1&quot;</span><span class="p">,</span> <span class="ss">area:</span> <span class="sd">&quot;</span><span class="s2">555&quot;</span><span class="p">,</span> <span class="ss">local:</span> <span class="no">nil</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">number1</span> <span class="o">=</span> <span class="no">Phone</span><span class="o">.</span><span class="n">new</span>
<span class="no">Phone</span><span class="p">[</span><span class="ss">country:</span> <span class="sd">&quot;</span><span class="s2">1&quot;</span><span class="p">,</span> <span class="ss">area:</span> <span class="sd">&quot;</span><span class="s2">555&quot;</span><span class="p">,</span> <span class="ss">local:</span> <span class="no">nil</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">number2</span> <span class="o">=</span> <span class="no">Phone</span><span class="o">.</span><span class="n">new</span> <span class="ss">local:</span> <span class="sd">&quot;</span><span class="s2">1212&quot;</span><span class="p">,</span> <span class="ss">country:</span> <span class="sd">&quot;</span><span class="s2">44&quot;</span>
<span class="no">Phone</span><span class="p">[</span><span class="ss">country:</span> <span class="sd">&quot;</span><span class="s2">44&quot;</span><span class="p">,</span> <span class="ss">area:</span> <span class="sd">&quot;</span><span class="s2">555&quot;</span><span class="p">,</span> <span class="ss">local:</span> <span class="sd">&quot;</span><span class="s2">1212&quot;</span><span class="p">]</span>

</pre>
<p>defrecord创建了一个elixir module,具有new function，这个new
function从参数创建一个tuple，tuple的第一个元素是module name，其他是tuple values
在iex里会被自动识别为一个record</p>

<ol>
<li>Lists and Keyword Lists</li>
</ol>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span> <span class="p">]</span> <span class="o">++</span> <span class="p">[</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span> <span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">]</span> <span class="o">--</span> <span class="p">[</span><span class="m">2</span><span class="p">,</span> <span class="m">4</span><span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="m">1</span> <span class="ow">in</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">]</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="sd">&quot;</span><span class="s2">wombat&quot;</span> <span class="ow">in</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">]</span>
<span class="no">false</span>
</pre>
<p>Keyword list 是一个用于key/value pair的shortcut</p>
<pre class="highlight elixir">
<span class="p">[</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">city:</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="ss">likes:</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span> <span class="p">]</span>

<span class="p">[</span> <span class="p">{</span><span class="ss">:name</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:city</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:likes</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span><span class="p">}</span> <span class="p">]</span>

<span class="no">DB</span><span class="o">.</span><span class="n">save</span> <span class="n">record</span><span class="p">,</span> <span class="p">[</span> <span class="p">{</span><span class="ss">:use_transaction</span><span class="p">,</span> <span class="no">true</span><span class="p">},</span> <span class="p">{</span><span class="ss">:logging</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">HIGH&quot;</span><span class="p">}</span> <span class="p">]</span>

<span class="no">DB</span><span class="o">.</span><span class="n">save</span> <span class="n">record</span><span class="p">,</span> <span class="ss">use_transaction:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">logging:</span> <span class="sd">&quot;</span><span class="s2">HIGH&quot;</span>

</pre>
<ol>
<li>Maps: a collection of key/value pairs, like %{key =&gt; value, key =&gt; value}</li>
</ol>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">states</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="sd">&quot;</span><span class="s2">AL&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Alabama&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">WI&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Wisconsin&quot;</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="sd">&quot;</span><span class="s2">AL&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Alabama&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">WI&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Wisconsin&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">response_types</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="p">{</span> <span class="ss">:error</span><span class="p">,</span> <span class="ss">:enoent</span> <span class="p">}</span> <span class="o">=&gt;</span> <span class="ss">:fatal</span><span class="p">,</span>
<span class="o">...&gt;</span> <span class="p">{</span> <span class="ss">:error</span><span class="p">,</span> <span class="ss">:busy</span> <span class="p">}</span> <span class="o">=&gt;</span> <span class="ss">:retry</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:busy</span><span class="p">}</span> <span class="o">=&gt;</span> <span class="ss">:retry</span><span class="p">,</span> <span class="p">{</span><span class="ss">:error</span><span class="p">,</span> <span class="ss">:enoent</span><span class="p">}</span> <span class="o">=&gt;</span> <span class="ss">:fatal</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">colors</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="ss">:red</span> <span class="o">=&gt;</span> <span class="m">0xff0000</span><span class="p">,</span> <span class="ss">:green</span> <span class="o">=&gt;</span> <span class="m">0x00ff00</span><span class="p">,</span> <span class="ss">:blue</span> <span class="o">=&gt;</span> <span class="m">0x0000ff</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="ss">blue:</span> <span class="m">255</span><span class="p">,</span> <span class="ss">green:</span> <span class="m">65280</span><span class="p">,</span> <span class="ss">red:</span> <span class="m">16711680</span><span class="p">}</span>
</pre>
<p>如果map的key是atom类型，那么也可以用keyword list的shortcut</p>

<p>为什么要有keyword list和map？</p>

<p>map不允许重复的key，keyword可以，map效率高，而且可以用pattern matching</p>

<p>通常keyword list可以用于命令行参数，map和HashDict可以用于关联数组</p>

<p>访问map</p>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">states</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="sd">&quot;</span><span class="s2">AL&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Alamaba&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">WI&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Wisconsin&quot;</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="sd">&quot;</span><span class="s2">AL&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Alamaba&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">WI&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">Wisconsin&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">states</span><span class="p">[</span><span class="sd">&quot;</span><span class="s2">AL&quot;</span><span class="p">]</span>
<span class="sd">&quot;</span><span class="s2">Alamaba&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">states</span><span class="p">[</span><span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">]</span>
<span class="no">nil</span>

<span class="c1">#如果key是atom，可以使用dot形式</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">colors</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="ss">red:</span> <span class="m">0xff0000</span><span class="p">,</span> <span class="ss">green:</span> <span class="m">0x00ff00</span><span class="p">,</span> <span class="ss">blue:</span> <span class="m">0x0000ff</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="ss">blue:</span> <span class="m">255</span><span class="p">,</span> <span class="ss">green:</span> <span class="m">65280</span><span class="p">,</span> <span class="ss">red:</span> <span class="m">16711680</span><span class="p">}</span>
<span class="n">iex</span><span class="p">(</span><span class="m">27</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">colors</span><span class="p">[</span><span class="ss">:red</span><span class="p">]</span>
<span class="m">16711680</span>
<span class="n">iex</span><span class="p">(</span><span class="m">28</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">colors</span><span class="o">.</span><span class="n">green</span>
<span class="m">65280</span>
</pre>
<ol>
<li>Binaries, 形式如&lt;&lt; 1,2 &gt;&gt;</li>
</ol>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">bin</span> <span class="o">=</span> <span class="o">&lt;&lt;</span><span class="m">3</span> <span class="p">::</span> <span class="n">size</span><span class="p">(</span><span class="m">2</span><span class="p">),</span> <span class="m">5</span> <span class="p">::</span> <span class="n">size</span><span class="p">(</span><span class="m">4</span><span class="p">),</span> <span class="m">1</span> <span class="p">::</span> <span class="n">size</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="o">&gt;&gt;</span>
<span class="o">&lt;&lt;</span><span class="m">213</span><span class="o">&gt;&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:io</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="sd">&quot;</span><span class="s2">~-8.2b~n&quot;</span><span class="p">,</span> <span class="ss">:binary</span><span class="o">.</span><span class="n">bin_to_list</span><span class="p">(</span><span class="n">bin</span><span class="p">))</span>
<span class="m">11010101</span>
<span class="ss">:ok</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">size</span> <span class="n">bin</span>
<span class="m">1</span>

</pre>
<h3>Names, Source Files, Conventions, Operators</h3>

<p>Module, record, protocol, and behavior names start with an uppercase letter
and are BumpyCase. All other identifiers start with a lower case letter or
underscore</p>

<p><a name="anonymous_functions"></a></p>

<h2>Anonymous Functions</h2>
<pre class="highlight elixir">
<span class="k">fn</span>
  <span class="n">parameter</span><span class="o">-</span><span class="n">list</span> <span class="o">-&gt;</span> <span class="n">body</span>
  <span class="n">parameter</span><span class="o">-</span><span class="n">list</span> <span class="o">-&gt;</span> <span class="n">body</span> <span class="o">...</span>
<span class="k">end</span>
</pre>
<ol>
<li>函数可以在参数做pattern matching</li>
<li>函数可以有多个函数体</li>
<li>函数可以返回函数</li>
<li>函数可以作为参数传入</li>
</ol>
<pre class="highlight elixir"><span class="c1">#&amp; shortcut</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="n">add_one</span> <span class="o">=</span> <span class="err">&amp;</span><span class="p">(</span><span class="nv">&amp;1</span> <span class="o">+</span> <span class="m">1</span><span class="p">)</span>
<span class="c1"># same as add_one = fn (n) -&gt; n + 1 end</span>
<span class="c1">#Function&lt;6.17052888 in :erl_eval.expr/5&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">add_one</span><span class="o">.</span><span class="p">(</span><span class="m">44</span><span class="p">)</span>
<span class="m">45</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">square</span> <span class="o">=</span> <span class="err">&amp;</span><span class="p">(</span><span class="nv">&amp;1</span> <span class="o">*</span> <span class="nv">&amp;1</span><span class="p">)</span>
<span class="c1">#Function&lt;6.17052888 in :erl_eval.expr/5&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">square</span><span class="o">.</span><span class="p">(</span><span class="m">8</span><span class="p">)</span>
<span class="m">64</span>
<span class="c1">#elixir会优化下面的代码，直接调用IO.puts</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">speak</span> <span class="o">=</span> <span class="err">&amp;</span><span class="p">(</span><span class="no">IO</span><span class="o">.</span><span class="n">puts</span><span class="p">(</span><span class="nv">&amp;1</span><span class="p">))</span>
<span class="err">&amp;</span><span class="no">IO</span><span class="o">.</span><span class="n">puts</span><span class="o">/</span><span class="m">1</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">speak</span><span class="o">.</span><span class="p">(</span><span class="sd">&quot;</span><span class="s2">Hello&quot;</span><span class="p">)</span>
<span class="no">Hello</span>
<span class="ss">:ok</span>

<span class="c1">#第二种形式：</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="err">&amp;</span><span class="n">length</span><span class="o">/</span><span class="m">1</span>
<span class="err">&amp;</span><span class="ss">:erlang</span><span class="o">.</span><span class="n">length</span><span class="o">/</span><span class="m">1</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">l</span><span class="o">.</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">7</span><span class="p">])</span>
<span class="m">4</span>
</pre>
<p><a name="modules_and_named_functions"></a></p>

<h2>Modules and Named Functions</h2>

<p>这章讲如何使用命名函数，和在module里放置这些函数</p>
<pre class="highlight elixir">
<span class="k">defmodule</span> <span class="no">Times</span> <span class="k">do
  def</span> <span class="n">double</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">do
    </span><span class="n">n</span> <span class="o">*</span> <span class="m">2</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<h3>do &hellip; end 是语法糖，编译时都会转化为后do: 这种形式</h3>
<pre class="highlight elixir"><span class="k">def</span> <span class="n">double</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="m">2</span>

<span class="k">def</span> <span class="n">greet</span><span class="p">(</span><span class="n">greeting</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="p">(</span>
  <span class="no">IO</span><span class="o">.</span><span class="n">puts</span> <span class="sd">&quot;</span><span class="s2">How&#39;re you doing, </span><span class="si">#{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">)</span>

</pre>
<h3>default parameters</h3>
<pre class="highlight elixir"><span class="k">defmodule</span> <span class="no">Example</span> <span class="k">do
  def</span> <span class="n">func</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span> <span class="p">\\</span> <span class="m">2</span><span class="p">,</span> <span class="n">p3</span> <span class="p">\\</span> <span class="m">3</span><span class="p">,</span> <span class="n">p4</span><span class="p">)</span> <span class="k">do
    </span><span class="no">IO</span><span class="o">.</span><span class="n">inspect</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">,</span> <span class="n">p3</span><span class="p">,</span> <span class="n">p4</span><span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
<h3>|&gt; pipe operator会把左边的expression作为右边函数的第一个参数</h3>

<h3>Modules</h3>

<p>modules在elixir里作为namespaces,可以wrap named functions, macros, structs,
protocols, 和其他modules</p>

<p>实际上，所有module都定义在top level，Elixir只是自动通过.来连接外部module</p>

<h3>Directives for Modules</h3>

<h4>import 把module里的function/macro放到正在运行的scope</h4>
<pre class="highlight elixir">
<span class="k">defmodule</span> <span class="no">Example</span> <span class="k">do
  def</span> <span class="n">func1</span> <span class="k">do
    </span><span class="no">List</span><span class="o">.</span><span class="n">flatten</span> <span class="p">[</span><span class="m">1</span><span class="p">,[</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span><span class="m">4</span><span class="p">]</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">func2</span> <span class="k">do
    </span><span class="kn">import</span> <span class="no">List</span><span class="p">,</span> <span class="ss">only:</span> <span class="p">[</span><span class="ss">flatten:</span> <span class="m">1</span><span class="p">]</span>
    <span class="n">flatten</span> <span class="p">[</span><span class="m">5</span><span class="p">,[</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">],</span><span class="m">8</span><span class="p">]</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="c1">#syntax 是 import Module [, only: [except: ]</span>

<span class="kn">import</span> <span class="no">List</span><span class="p">,</span> <span class="ss">only:</span> <span class="p">[</span> <span class="ss">flatten:</span> <span class="m">1</span><span class="p">,</span> <span class="ss">duplicate:</span> <span class="m">2</span> <span class="p">]</span>

</pre>
<h4>alias</h4>

<p>定义module的别名</p>

<h4>require</h4>

<p>如果需要使用定义在module的macro，就要使用require</p>

<h3>Module Attributes</h3>
<pre class="highlight elixir">
<span class="nv">@name</span> <span class="n">value</span>
</pre>
<p>只可以在module顶部定义值，但是可在其他地方读取值,这不是变量，通常用于设置</p>

<h3>Module Names: Elixir, Erlang, and Atoms</h3>

<p>module name实际上是atom</p>
<pre class="highlight elixir"><span class="n">ex</span><span class="o">&gt;</span> <span class="n">is_atom</span> <span class="no">IO</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">to_string</span> <span class="no">IO</span>
<span class="sd">&quot;</span><span class="s2">Elixir.IO&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:&quot;Elixir.IO&quot;</span> <span class="o">===</span> <span class="no">IO</span>
<span class="no">true</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">IO</span><span class="o">.</span><span class="n">puts</span> <span class="m">123</span>
<span class="m">123</span>
<span class="ss">:ok</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:&quot;Elixir.IO&quot;</span><span class="o">.</span><span class="n">puts</span> <span class="m">123</span>
<span class="m">123</span>
<span class="ss">:ok</span>

</pre>
<p>在Erlang里，变量才是大写开头，atom是小写的，Erlang里的timer module在Elixir就是:timer,所以需要用下面的方式调用ERlang module</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:io</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="sd">&quot;</span><span class="s2">The number is ~3.1f~n&quot;</span><span class="p">,</span> <span class="p">[</span><span class="m">5.678</span><span class="p">])</span>
<span class="no">The</span> <span class="n">number</span> <span class="n">is</span> <span class="m">5.7</span>
<span class="ss">:ok</span>

</pre>
<h3>寻找Library</h3>

<p><a href="http://expm.co">expm.co</a></p>

<p><a name="lists_and_recursion"></a></p>

<h2>Lists and Recursion</h2>

<ol>
<li>使用Head, Tail处理List</li>
<li>使用Head, Tail创建List</li>
<li>Map function</li>
<li>在recursion时保持值</li>
<li>sum函数</li>
<li>复杂的List Patterns</li>
<li>List Module</li>
</ol>
<pre class="highlight elixir">  <span class="k">def</span> <span class="n">len</span> <span class="p">([])</span> <span class="k">do
    </span><span class="m">0</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">len</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">])</span> <span class="k">do
    </span><span class="m">1</span> <span class="o">+</span> <span class="n">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">square</span><span class="p">([])</span> <span class="k">do
    </span><span class="p">[]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">square</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">])</span> <span class="k">do
    </span><span class="p">[</span><span class="n">h</span><span class="o">*</span><span class="n">h</span> <span class="o">|</span> <span class="n">square</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">add1</span><span class="p">([])</span> <span class="k">do
    </span><span class="p">[]</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">add1</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">])</span> <span class="k">do
    </span><span class="p">[</span><span class="n">h</span><span class="o">+</span><span class="m">1</span><span class="o">|</span><span class="n">add1</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">map</span><span class="p">([],</span> <span class="n">fun</span><span class="p">)</span> <span class="k">do
    </span><span class="p">[]</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">map</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">],</span> <span class="n">fun</span><span class="p">)</span> <span class="k">do
    </span><span class="p">[</span><span class="n">fun</span><span class="o">.</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">|</span><span class="n">map</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fun</span><span class="p">)]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">sum</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">_sum</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="m">0</span><span class="p">)</span>
  <span class="k">defp</span> <span class="n">_sum</span><span class="p">([],</span><span class="n">s</span><span class="p">)</span> <span class="k">do
    </span><span class="n">s</span>
  <span class="k">end</span>
  <span class="k">defp</span> <span class="n">_sum</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">],</span><span class="n">s</span><span class="p">)</span> <span class="k">do
    </span><span class="n">_sum</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">s</span><span class="o">+</span><span class="n">h</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">reduce</span><span class="p">([],</span> <span class="n">init_val</span><span class="p">,</span> <span class="n">fun</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">init_val</span>
  <span class="k">def</span> <span class="n">reduce</span><span class="p">([</span><span class="n">h</span><span class="o">|</span><span class="n">t</span><span class="p">],</span> <span class="n">init_val</span><span class="p">,</span> <span class="n">fun</span><span class="p">)</span> <span class="k">do
    </span><span class="n">reduce</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">fun</span><span class="o">.</span><span class="p">(</span><span class="n">init_val</span><span class="p">,</span><span class="n">h</span><span class="p">),</span> <span class="n">fun</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="n">for_location</span><span class="p">([],</span> <span class="n">target_loc</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="p">[]</span>
  <span class="k">def</span> <span class="n">for_location</span><span class="p">([</span> <span class="n">head</span> <span class="o">=</span> <span class="p">[</span><span class="n">_</span><span class="p">,</span> <span class="n">target_loc</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="p">]</span> <span class="o">|</span> <span class="n">tail</span><span class="p">],</span> <span class="n">target_loc</span><span class="p">)</span> <span class="k">do
    </span><span class="p">[</span> <span class="n">head</span> <span class="o">|</span> <span class="n">for_location</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">target_loc</span><span class="p">)</span> <span class="p">]</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">for_location</span><span class="p">([</span> <span class="n">_</span> <span class="o">|</span> <span class="n">tail</span><span class="p">],</span> <span class="n">target_loc</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">for_location</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">target_loc</span><span class="p">)</span>

<span class="k">end</span>

<span class="c1"># 头部不必只有一个元素</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span> <span class="o">|</span> <span class="p">[</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span> <span class="p">]]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">]</span>

</pre>
<p>List Module</p>
<pre class="highlight elixir"><span class="c1">#</span>
<span class="c1"># Concatenate lists</span>
<span class="c1">#</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">]</span> <span class="o">++</span> <span class="p">[</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># Flatten</span>
<span class="c1">#</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">flatten</span><span class="p">([[[</span><span class="m">1</span><span class="p">],</span> <span class="m">2</span><span class="p">],</span> <span class="p">[[[</span><span class="m">3</span><span class="p">]]]])</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">]</span>
<span class="c1">#</span>
<span class="c1"># Folding (like reduce, but can choose direction)</span>
<span class="c1">#</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">foldl</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">fn</span> <span class="n">value</span><span class="p">,</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="sd">&quot;</span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">(</span><span class="si">#{</span><span class="n">acc</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">end</span><span class="p">)</span>
<span class="sd">&quot;</span><span class="s2">3(2(1()))&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">foldr</span><span class="p">([</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="k">fn</span> <span class="n">value</span><span class="p">,</span> <span class="n">acc</span> <span class="o">-&gt;</span> <span class="sd">&quot;</span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">(</span><span class="si">#{</span><span class="n">acc</span><span class="si">}</span><span class="s2">)&quot;</span> <span class="k">end</span><span class="p">)</span>
<span class="sd">&quot;</span><span class="s2">1(2(3()))&quot;</span>
<span class="c1">#</span>
<span class="c1"># Merging lists and splitting them apart</span>
<span class="c1">#</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">l</span> <span class="o">=</span> <span class="no">List</span><span class="o">.</span><span class="n">zip</span><span class="p">([[</span><span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">],</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span><span class="ss">:b</span><span class="p">,</span><span class="ss">:c</span><span class="p">],</span> <span class="p">[</span><span class="sd">&quot;</span><span class="s2">cat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">dog&quot;</span><span class="p">]])</span>
<span class="p">[{</span><span class="m">1</span><span class="p">,</span> <span class="ss">:a</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">cat&quot;</span><span class="p">},</span> <span class="p">{</span><span class="m">2</span><span class="p">,</span> <span class="ss">:b</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">dog&quot;</span><span class="p">}]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">unzip</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="p">[[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">],</span> <span class="p">[</span><span class="ss">:a</span><span class="p">,</span> <span class="ss">:b</span><span class="p">],</span> <span class="p">[</span><span class="sd">&quot;</span><span class="s2">cat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">dog&quot;</span><span class="p">]]</span>
<span class="c1">#</span>
<span class="c1"># Accessing tuples within lists</span>
<span class="c1">#</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">kw</span> <span class="o">=</span> <span class="p">[{</span><span class="ss">:name</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:likes</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:where</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">}]</span>
<span class="p">[{</span><span class="ss">:name</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:likes</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:where</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">}]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">keyfind</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:where</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">keyfind</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="p">{</span><span class="ss">:where</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dallas&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">keyfind</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
<span class="no">nil</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">keyfind</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">No city called TX&quot;</span><span class="p">)</span>
<span class="sd">&quot;</span><span class="s2">No city called TX&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">kw</span> <span class="o">=</span> <span class="no">List</span><span class="o">.</span><span class="n">keydelete</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">TX&quot;</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span>
<span class="p">[</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">likes:</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">kw</span> <span class="o">=</span> <span class="no">List</span><span class="o">.</span><span class="n">keyreplace</span><span class="p">(</span><span class="n">kw</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="p">{</span><span class="ss">:first_name</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">})</span>
<span class="p">[</span><span class="ss">first_name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">likes:</span> <span class="sd">&quot;</span><span class="s2">Programming&quot;</span><span class="p">]</span>

</pre>
<p><a name="maps_hashdicts_keyword_and_sets"></a></p>

<h2>Maps, HashDicts, Keyword, and Sets</h2>

<p>Dictionary是一种把key和value关联起来的数据类型</p>

<h3>如何在Map，HashDict和Keyword之间选</h3>

<ol>
<li>如果有重复key： Keyword</li>
<li>如果需要有序： Keyword</li>
<li>pattern matching： map</li>
<li>数据大于几百条： HashDict</li>
</ol>

<h3>Dict</h3>

<p>Map和HashDict实现了Dict的behaviour，Keyword实现了大部分，应该用Dict module的method，这样不管底层是用map还是HashDict，都会带来更多的灵活性。</p>

<h3>Dictionaries</h3>
<pre class="highlight text">
defmodule Sum do
  def values(dict) do
    dict |&gt; Dict.values |&gt; Enum.sum
  end
end
# Sum a HashDict
hd = [ one: 1, two: 2, three: 3 ] |&gt; Enum.into HashDict.new
IO.puts Sum.values(hd) # =&gt; 6
# Sum a Map
map = %{ four: 4, five: 5, six: 6 }
IO.puts Sum.values(map) # =&gt; 15

# Dict API examples
iex&gt; kw_list = [name: &quot;Dave&quot;, likes: &quot;Programming&quot;, where: &quot;Dallas&quot;]
[name: &quot;Dave&quot;, likes: &quot;Programming&quot;, where: &quot;Dallas&quot;]
iex&gt; hashdict = Enum.into kw_list, HashDict.new
#HashDict&lt;[name: &quot;Dave&quot;, where: &quot;Dallas&quot;, likes: &quot;Programming&quot;]&gt;
iex&gt; map = Enum.into kw_list, Map.new
%{likes: &quot;Programming&quot;, name: &quot;Dave&quot;, where: &quot;Dallas&quot;}
iex&gt; kw_list[:name]
&quot;Dave&quot;
iex&gt; hashdict[:likes]
&quot;Programming&quot;
iex&gt; map[:where]
&quot;Dallas&quot;
iex&gt; hashdict = Dict.drop(hashdict, [:where, :likes])
#HashDict&lt;[name: &quot;Dave&quot;]&gt;
iex&gt; hashdict = Dict.put(hashdict, :also_likes, &quot;Ruby&quot;)
#HashDict&lt;[name: &quot;Dave&quot;, also_likes: &quot;Ruby&quot;]&gt;
iex&gt; combo = Dict.merge(map, hashdict)
%{also_likes: &quot;Ruby&quot;, likes: &quot;Programming&quot;, name: &quot;Dave&quot;, where: &quot;Dallas&quot;}

# 用Keyword module读duplicated keyword
iex(51)&gt; kw_list = [name: &quot;Dave&quot;, likes: &quot;Programming&quot;, likes: &quot;Elixir&quot;]
[name: &quot;Dave&quot;, likes: &quot;Programming&quot;, likes: &quot;Elixir&quot;]
iex(53)&gt; kw_list[:likes]
&quot;Programming&quot;
iex(54)&gt; Dict.get(kw_list, :likes)
&quot;Programming&quot;
iex(55)&gt; Keyword.get_values(kw_list, :likes)
[&quot;Programming&quot;, &quot;Elixir&quot;]
</pre>
<h4>Pattern Matching and updating map</h4>

<p>对于map，经常会问下面的问题</p>

<ol>
<li>is there an entry with the key :name ?</li>
<li>are there entries for the keys :name and :height ?</li>
<li>does the entry with key :name have the value &ldquo;Dave&rdquo; ?</li>
</ol>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">person</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">height:</span> <span class="m">1.88</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="ss">height:</span> <span class="m">1.88</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">%</span><span class="p">{</span> <span class="ss">name:</span> <span class="n">a_name</span> <span class="p">}</span> <span class="o">=</span> <span class="n">person</span>
<span class="err">%</span><span class="p">{</span><span class="ss">height:</span> <span class="m">1.88</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">a_name</span>
<span class="sd">&quot;</span><span class="s2">Dave&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">%</span><span class="p">{</span> <span class="ss">name:</span> <span class="n">_</span><span class="p">,</span> <span class="ss">height:</span> <span class="n">_</span> <span class="p">}</span> <span class="o">=</span> <span class="n">person</span>
<span class="err">%</span><span class="p">{</span><span class="ss">height:</span> <span class="m">1.88</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">%</span><span class="p">{</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span> <span class="p">}</span> <span class="o">=</span> <span class="n">person</span>
<span class="err">%</span><span class="p">{</span><span class="ss">height:</span> <span class="m">1.88</span><span class="p">,</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">}</span>

</pre><pre class="highlight elixir"><span class="c1">#利用在map里的解构,简化pattern matching</span>

<span class="n">for</span> <span class="n">person</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="ss">height:</span> <span class="n">height</span> <span class="p">}</span> <span class="o">&lt;-</span> <span class="n">people</span><span class="p">,</span>
  <span class="n">height</span> <span class="o">&gt;</span> <span class="m">1.5</span><span class="p">,</span>
  <span class="k">do</span><span class="p">:</span> <span class="no">IO</span><span class="o">.</span><span class="n">inspect</span> <span class="n">person</span>

</pre>
<p>Limitation: 只能在值做pattern matching, 不能在key做pattern matching</p>

<h3>update map</h3>
<pre class="highlight elixir">
<span class="n">new_map</span> <span class="o">=</span> <span class="err">%</span><span class="p">{</span> <span class="n">old_map</span> <span class="o">|</span> <span class="n">key</span> <span class="o">=&gt;</span> <span class="n">value</span><span class="p">,</span> <span class="o">...</span> <span class="p">}</span>

</pre>
<h3>Maps and Structs</h3>

<p>当使用 %{}时，elixir知道这是一个map，但不知道更多的结构信息，因此引入Struct</p>

<p>可以创建一种map，但是有固定的fields，缺省值，pattern matching可以用content或者type</p>

<p>Struct是一个module，封装了限制形式的map，module的名字也是map类型的名字</p>
<pre class="highlight elixir">
<span class="k">defmodule</span> <span class="no">Subscriber</span> <span class="k">do
  </span><span class="n">defstruct</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span>
<span class="k">end</span>

<span class="err">$</span> <span class="n">iex</span> <span class="n">defstruct</span><span class="o">.</span><span class="n">exs</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">s1</span> <span class="o">=</span> <span class="err">%</span><span class="no">Subscriber</span><span class="p">{}</span>
<span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">s2</span> <span class="o">=</span> <span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span> <span class="p">}</span>
<span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">s3</span> <span class="o">=</span> <span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Mary&quot;</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">true</span> <span class="p">}</span>
<span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Mary&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">true</span><span class="p">}</span>

<span class="c1">#可以用.或pattern matching来访问field</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="n">s3</span><span class="o">.</span><span class="n">name</span>
<span class="sd">&quot;</span><span class="s2">Mary&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="n">a_name</span><span class="p">}</span> <span class="o">=</span> <span class="n">s3</span>
<span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Mary&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">true</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">a_name</span>
<span class="sd">&quot;</span><span class="s2">Mary&quot;</span>

<span class="c1">#update</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="n">s4</span> <span class="o">=</span> <span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span> <span class="n">s3</span> <span class="o">|</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Marie&quot;</span><span class="p">}</span>
<span class="err">%</span><span class="no">Subscriber</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Marie&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">true</span><span class="p">}</span>
</pre>
<p>用module封装Struct的目的是可以定义struct特定的行为</p>
<pre class="highlight elixir"><span class="k">defmodule</span> <span class="no">Attendee</span> <span class="k">do
  </span><span class="n">defstruct</span> <span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span>
  <span class="k">def</span> <span class="n">may_attend_after_party</span><span class="p">(</span><span class="n">attendee</span> <span class="o">=</span> <span class="err">%</span><span class="no">Attendee</span><span class="p">{})</span> <span class="k">do
    </span><span class="n">attendee</span><span class="o">.</span><span class="n">paid</span> <span class="o">&amp;&amp;</span> <span class="n">attendee</span><span class="o">.</span><span class="n">over_18</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">print_vip_badge</span><span class="p">(</span><span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="ss">name:</span> <span class="n">name</span><span class="p">})</span> <span class="ow">when</span> <span class="n">name</span> <span class="o">!=</span> <span class="sd">&quot;</span><span class="s2">&quot;</span> <span class="k">do
    </span><span class="no">IO</span><span class="o">.</span><span class="n">puts</span> <span class="sd">&quot;</span><span class="s2">Very cheap badge for </span><span class="si">#{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
  <span class="k">def</span> <span class="n">print_vip_badge</span><span class="p">(</span><span class="err">%</span><span class="no">Attendee</span><span class="p">{})</span> <span class="k">do
    raise</span> <span class="sd">&quot;</span><span class="s2">missing name for badge&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="err">$</span> <span class="n">iex</span> <span class="n">defstruct1</span><span class="o">.</span><span class="n">exs</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">a1</span> <span class="o">=</span> <span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">}</span>
<span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Attendee</span><span class="o">.</span><span class="n">may_attend_after_party</span><span class="p">(</span><span class="n">a1</span><span class="p">)</span>
<span class="no">false</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">a2</span> <span class="o">=</span> <span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="n">a1</span> <span class="o">|</span> <span class="ss">paid:</span> <span class="no">true</span><span class="p">}</span>
<span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">true</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Attendee</span><span class="o">.</span><span class="n">may_attend_after_party</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="no">true</span>
<span class="n">iex</span><span class="p">(</span><span class="m">22</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">Attendee</span><span class="o">.</span><span class="n">print_vip_badge</span><span class="p">(</span><span class="n">a2</span><span class="p">)</span>
<span class="no">Very</span> <span class="n">cheap</span> <span class="n">badge</span> <span class="n">for</span> <span class="no">Dave</span>
<span class="ss">:ok</span>
<span class="n">iex</span><span class="p">(</span><span class="m">23</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">a3</span> <span class="o">=</span> <span class="err">%</span><span class="no">Attendee</span><span class="p">{}</span>
<span class="err">%</span><span class="no">Attendee</span><span class="p">{</span><span class="ss">name:</span> <span class="sd">&quot;</span><span class="s2">&quot;</span><span class="p">,</span> <span class="ss">over_18:</span> <span class="no">true</span><span class="p">,</span> <span class="ss">paid:</span> <span class="no">false</span><span class="p">}</span>
<span class="n">iex</span><span class="p">(</span><span class="m">26</span><span class="p">)</span><span class="o">&gt;</span> <span class="no">Attendee</span><span class="o">.</span><span class="n">print_vip_badge</span><span class="p">(</span><span class="n">a3</span><span class="p">)</span>
<span class="o">**</span> <span class="p">(</span><span class="no">RuntimeError</span><span class="p">)</span> <span class="n">missing</span> <span class="n">name</span> <span class="n">for</span> <span class="n">badge</span>
<span class="n">defstruct1</span><span class="o">.</span><span class="ss">exs:</span><span class="m">13</span><span class="p">:</span> <span class="no">Attendee</span><span class="o">.</span><span class="n">print_vip_badge</span><span class="o">/</span><span class="m">1</span>
</pre>
<h3>Sets</h3>

<p>目前只有一种实现：HashSet</p>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">set1</span> <span class="o">=</span> <span class="no">Enum</span><span class="o">.</span><span class="n">into</span> <span class="m">1</span><span class="o">..</span><span class="m">5</span><span class="p">,</span> <span class="no">HashSet</span><span class="o">.</span><span class="n">new</span>
<span class="c1">#HashSet&lt;[1, 2, 3, 4, 5]&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Set</span><span class="o">.</span><span class="n">member?</span> <span class="n">set1</span><span class="p">,</span> <span class="m">3</span>
<span class="no">true</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">set2</span> <span class="o">=</span> <span class="no">Enum</span><span class="o">.</span><span class="n">into</span> <span class="m">3</span><span class="o">..</span><span class="m">8</span><span class="p">,</span> <span class="no">HashSet</span><span class="o">.</span><span class="n">new</span>
<span class="c1">#HashSet&lt;[3, 4, 5, 6, 7, 8]&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Set</span><span class="o">.</span><span class="n">union</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span>
<span class="c1">#HashSet&lt;[7, 6, 4, 1, 8, 2, 3, 5]&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Set</span><span class="o">.</span><span class="n">difference</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span>
<span class="c1">#HashSet&lt;[1, 2]&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Set</span><span class="o">.</span><span class="n">difference</span> <span class="n">set2</span><span class="p">,</span> <span class="n">set1</span>
<span class="c1">#HashSet&lt;[6, 7, 8]&gt;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Set</span><span class="o">.</span><span class="n">intersection</span> <span class="n">set1</span><span class="p">,</span> <span class="n">set2</span>
<span class="c1">#HashSet&lt;[3, 4, 5]&gt;</span>

</pre>
<p><a name="what_are_types"></a></p>

<h2>What are types</h2>

<p>Elixir中的数据，既是有primitive type，又有List，Keyword这些抽象module，这可以看作是一种duck type,类似于动态面向对象语言。</p>
<pre class="highlight elixir">
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">options</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span><span class="ss">:width</span><span class="p">,</span> <span class="m">72</span><span class="p">},</span> <span class="p">{</span><span class="ss">:style</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">light&quot;</span><span class="p">},</span> <span class="p">{</span><span class="ss">:style</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">print&quot;</span><span class="p">}</span> <span class="p">]</span>
<span class="p">[</span><span class="ss">width:</span> <span class="m">72</span><span class="p">,</span> <span class="ss">style:</span> <span class="sd">&quot;</span><span class="s2">light&quot;</span><span class="p">,</span> <span class="ss">style:</span> <span class="sd">&quot;</span><span class="s2">print&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">List</span><span class="o">.</span><span class="n">last</span> <span class="n">options</span>
<span class="p">{</span><span class="ss">:style</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">print&quot;</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Keyword</span><span class="o">.</span><span class="n">get_values</span> <span class="n">options</span><span class="p">,</span> <span class="ss">:style</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">light&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">print&quot;</span><span class="p">]</span>

</pre>
<p><a name="processing_collections_enums_and_stream"></a></p>

<h2>Processing Collections&ndash;Enums and Stream</h2>

<p>Elixir中提供2个关于iteration的module</p>

<ol>
<li><a href="http://elixir-lang.org/docs/stable/elixir/Enum.html">Enum</a>: Processing collections</li>
<li><a href="http://elixir-lang.org/docs/stable/elixir/Stream.html">Stream</a>: Lazy enumerables</li>
</ol>

<h3>Enum</h3>

<h3>Stream</h3>

<ol>
<li>Stream.cycle</li>
<li>Stream.repeatly</li>
<li>Stream.iterate</li>
<li>Stream.unfold</li>
<li>Stream.resource</li>
</ol>

<h3>Collectable protocol</h3>

<p>Collectable protocol和Enumermable相反，通过插入元素来创建collection</p>

<p>Collectable的API是底层使用的较多，用户通常通过Enum.into和comprehension来使用。</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">into</span> <span class="m">1</span><span class="o">..</span><span class="m">5</span><span class="p">,</span> <span class="p">[]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">]</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Enum</span><span class="o">.</span><span class="n">into</span> <span class="m">1</span><span class="o">..</span><span class="m">5</span><span class="p">,</span> <span class="p">[</span><span class="m">100</span><span class="p">,</span> <span class="m">101</span> <span class="p">]</span>
<span class="p">[</span><span class="m">100</span><span class="p">,</span> <span class="m">101</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">]</span>
</pre>
<h3>Comprehension</h3>

<p>形式如下：</p>
<pre class="highlight elixir"><span class="n">result</span> <span class="o">=</span> <span class="n">for</span> <span class="n">generator</span> <span class="ow">or</span> <span class="n">filter</span><span class="o">...</span> <span class="p">[</span> <span class="p">,</span> <span class="ss">into:</span> <span class="n">value</span> <span class="p">]</span> <span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="n">expression</span>
</pre>
<p>generator是指定如何从一个collection里抽取值,而且可以有多个generator clause</p>
<pre class="highlight elixir"><span class="n">pattern</span> <span class="o">&lt;-</span> <span class="n">list</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="n">mix_maxes</span> <span class="o">=</span> <span class="p">[{</span><span class="m">1</span><span class="p">,</span><span class="m">4</span><span class="p">},</span> <span class="p">{</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">},</span> <span class="p">{</span><span class="m">10</span><span class="p">,</span> <span class="m">15</span><span class="p">}]</span>
<span class="p">[{</span><span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">},</span> <span class="p">{</span><span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">},</span> <span class="p">{</span><span class="m">10</span><span class="p">,</span> <span class="m">15</span><span class="p">}]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="p">{</span><span class="n">min</span><span class="p">,</span><span class="n">max</span><span class="p">}</span> <span class="o">&lt;-</span> <span class="n">mix_maxes</span><span class="p">,</span> <span class="n">n</span> <span class="o">&lt;-</span> <span class="n">min</span><span class="o">..</span><span class="n">max</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="n">n</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">10</span><span class="p">,</span> <span class="m">11</span><span class="p">,</span> <span class="m">12</span><span class="p">,</span> <span class="m">13</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="m">15</span><span class="p">]</span>

</pre>
<p>filter</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">first8</span> <span class="o">=</span> <span class="p">[</span> <span class="m">1</span><span class="p">,</span><span class="m">2</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">4</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">8</span> <span class="p">]</span>
<span class="p">[</span><span class="m">1</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">3</span><span class="p">,</span> <span class="m">4</span><span class="p">,</span> <span class="m">5</span><span class="p">,</span> <span class="m">6</span><span class="p">,</span> <span class="m">7</span><span class="p">,</span> <span class="m">8</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="n">first8</span><span class="p">,</span> <span class="n">y</span> <span class="o">&lt;-</span> <span class="n">first8</span><span class="p">,</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="n">y</span><span class="p">,</span> <span class="n">rem</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="p">,</span> <span class="m">10</span><span class="p">)</span><span class="o">==</span><span class="m">0</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="p">{</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="p">}</span>
<span class="p">[{</span><span class="m">5</span><span class="p">,</span> <span class="m">2</span><span class="p">},</span> <span class="p">{</span><span class="m">5</span><span class="p">,</span> <span class="m">4</span><span class="p">},</span> <span class="p">{</span><span class="m">6</span><span class="p">,</span> <span class="m">5</span><span class="p">},</span> <span class="p">{</span><span class="m">8</span><span class="p">,</span> <span class="m">5</span><span class="p">}]</span>
</pre>
<p>交换key value的例子</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">reports</span> <span class="o">=</span> <span class="p">[</span> <span class="ss">dallas:</span> <span class="ss">:hot</span><span class="p">,</span> <span class="ss">minneapolis:</span> <span class="ss">:cold</span><span class="p">,</span> <span class="ss">dc:</span> <span class="ss">:muggy</span><span class="p">,</span> <span class="ss">la:</span> <span class="ss">:smoggy</span> <span class="p">]</span>
<span class="p">[</span><span class="ss">dallas:</span> <span class="ss">:hot</span><span class="p">,</span> <span class="ss">minneapolis:</span> <span class="ss">:cold</span><span class="p">,</span> <span class="ss">dc:</span> <span class="ss">:muggy</span><span class="p">,</span> <span class="ss">la:</span> <span class="ss">:smoggy</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="p">{</span> <span class="n">city</span><span class="p">,</span> <span class="n">weather</span> <span class="p">}</span> <span class="o">&lt;-</span> <span class="n">reports</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="p">{</span> <span class="n">weather</span><span class="p">,</span> <span class="n">city</span> <span class="p">}</span>
<span class="p">[</span><span class="ss">hot:</span> <span class="ss">:dallas</span><span class="p">,</span> <span class="ss">cold:</span> <span class="ss">:minneapolis</span><span class="p">,</span> <span class="ss">muggy:</span> <span class="ss">:dc</span><span class="p">,</span> <span class="ss">smoggy:</span> <span class="ss">:la</span><span class="p">]</span>
</pre>
<h4>Comprehension Work on Bits</h4>
<pre class="highlight elixir">
<span class="n">ex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="o">&lt;&lt;</span> <span class="n">ch</span> <span class="o">&lt;-</span> <span class="sd">&quot;</span><span class="s2">hello&quot;</span> <span class="o">&gt;&gt;</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="n">ch</span>
<span class="s1">&#39;hello&#39;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="o">&lt;&lt;</span> <span class="n">ch</span> <span class="o">&lt;-</span> <span class="sd">&quot;</span><span class="s2">hello&quot;</span> <span class="o">&gt;&gt;</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="o">&lt;&lt;</span><span class="n">ch</span><span class="o">&gt;&gt;</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">h&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">e&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">l&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">l&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">o&quot;</span><span class="p">]</span>

<span class="c1">#注意&lt;-左边的是pattern</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="o">&lt;&lt;</span> <span class="o">&lt;&lt;</span> <span class="n">b1</span><span class="p">::</span><span class="n">size</span><span class="p">(</span><span class="m">2</span><span class="p">),</span> <span class="n">b2</span><span class="p">::</span><span class="n">size</span><span class="p">(</span><span class="m">3</span><span class="p">),</span> <span class="n">b3</span><span class="p">::</span><span class="n">size</span><span class="p">(</span><span class="m">3</span><span class="p">)</span> <span class="o">&gt;&gt;</span> <span class="o">&lt;-</span> <span class="sd">&quot;</span><span class="s2">hello&quot;</span> <span class="o">&gt;&gt;</span><span class="p">,</span> <span class="k">do</span><span class="p">:</span> <span class="sd">&quot;</span><span class="s2">0</span><span class="si">#{</span><span class="n">b1</span><span class="si">}#{</span><span class="n">b2</span><span class="si">}#{</span><span class="n">b3</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">0150&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">0145&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">0154&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">0154&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">0157&quot;</span><span class="p">]</span>


</pre>
<h4>scope</h4>

<p>在comprehension里的变量都是本地的，不会影响其他变量</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">name</span> <span class="o">=</span> <span class="sd">&quot;</span><span class="s2">Dave&quot;</span>
<span class="sd">&quot;</span><span class="s2">Dave&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="n">name</span> <span class="o">&lt;-</span> <span class="err">~</span><span class="n">w</span><span class="p">{</span> <span class="n">cat</span><span class="p">,</span> <span class="n">dog</span> <span class="p">},</span> <span class="k">do</span><span class="p">:</span> <span class="no">String</span><span class="o">.</span><span class="n">upcase</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">CAT,&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">DOG&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">name</span>
<span class="sd">&quot;</span><span class="s2">Dave&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span>
</pre>
<h4>Comprehension的返回值</h4>

<p>into指定collection来接收comprehension的结果</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="n">for</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="err">~</span><span class="n">w</span><span class="p">{</span> <span class="n">cat</span> <span class="n">dog</span> <span class="p">},</span> <span class="ss">into:</span> <span class="err">%</span><span class="p">{},</span> <span class="k">do</span><span class="p">:</span> <span class="p">{</span> <span class="n">x</span><span class="p">,</span> <span class="no">String</span><span class="o">.</span><span class="n">upcase</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">}</span>
<span class="err">%</span><span class="p">{</span><span class="sd">&quot;</span><span class="s2">cat&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">CAT&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">dog&quot;</span> <span class="o">=&gt;</span> <span class="sd">&quot;</span><span class="s2">DOG&quot;</span><span class="p">}</span>
<span class="c1"># into: 可以是实现了collectable protocol的值： lists, binaries, functions,</span>
<span class="c1"># maps, files, hash dicts, hashsets, IO streams</span>
<span class="n">for</span> <span class="n">x</span> <span class="o">&lt;-</span> <span class="err">~</span><span class="n">w</span><span class="p">{</span> <span class="n">cat</span> <span class="n">dog</span> <span class="p">},</span> <span class="ss">into:</span> <span class="no">IO</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="ss">:stdio</span><span class="p">,</span><span class="ss">:line</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="sd">&quot;</span><span class="s2">&lt;&lt;</span><span class="si">#{</span><span class="n">x</span><span class="si">}</span><span class="s2">&gt;&gt;\n&quot;</span>
<span class="o">&lt;&lt;</span><span class="n">cat</span><span class="o">&gt;&gt;</span>
<span class="o">&lt;&lt;</span><span class="n">dog</span><span class="o">&gt;&gt;</span>
<span class="err">%</span><span class="no">IO</span><span class="o">.</span><span class="no">Stream</span><span class="p">{</span><span class="ss">device:</span> <span class="ss">:standard_io</span><span class="p">,</span> <span class="ss">line_or_bytes:</span> <span class="ss">:line</span><span class="p">,</span> <span class="ss">raw:</span> <span class="no">false</span><span class="p">}</span>

</pre>
<p><a name="string_and_binaries"></a></p>

<h2>String and Binaries</h2>

<p>IO.write用于多行的string</p>

<h3>Heredocs &ldquo;&rdquo;&ldquo; 用于去掉多余的indent</h3>
<pre class="highlight elixir">
<span class="no">IO</span><span class="o">.</span><span class="n">write</span> <span class="sd">&quot;&quot;&quot;
   my
   string
&quot;&quot;&quot;</span>
</pre>
<h3>Sigils</h3>

<p>和ruby一样，elixir有一些其他的语法可以用来创建String</p>

<ol>
<li>~C a character list with no escaping or interpolation</li>
<li>~c a character list, escaped and interpolated just like a single quoted string</li>
<li>~R a regular expression with no escaping or interpolation</li>
<li>~r a regular expression, escaped and interpolated</li>
<li>~S string with no escaping or interpolation</li>
<li>~s string, escaped and interpolated just like a double quoted string</li>
<li>~W a list of whitespace-delimited words, with no escaping or interpolation</li>
<li>~w a list of whitespace-delimited words, with escaping and interpolation</li>
</ol>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="no">C</span><span class="p">[</span><span class="m">1</span><span class="p">\</span><span class="n">n2</span><span class="c1">#{1+2}]</span>
<span class="s1">&#39;1\\n2\#{1+2}&#39;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">c</span><span class="sd">&quot;</span><span class="s2">1\n2</span><span class="si">#{</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="s1">&#39;1\n23&#39;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="no">S</span><span class="p">[</span><span class="m">1</span><span class="p">\</span><span class="n">n2</span><span class="c1">#{1+2}]</span>
<span class="sd">&quot;</span><span class="s2">1\\n2\</span><span class="si">#{</span><span class="m">1</span><span class="o">+</span><span class="m">2</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">s</span><span class="o">/</span><span class="m">1</span><span class="p">\</span><span class="n">n2</span><span class="c1">#{1+2}/</span>
<span class="sd">&quot;</span><span class="s2">1\n23&quot;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="no">W</span><span class="p">[</span><span class="n">the</span> <span class="n">c</span><span class="c1">#{&#39;a&#39;}t sat on the mat]</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">c\</span><span class="si">#{</span><span class="s1">&#39;a&#39;</span><span class="si">}</span><span class="s2">t&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">sat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">on&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">mat&quot;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">w</span><span class="p">[</span><span class="n">the</span> <span class="n">c</span><span class="c1">#{&#39;a&#39;}t sat on the mat]</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">cat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">sat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">on&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">mat&quot;</span><span class="p">]</span>
</pre>
<p>~W ~w 可以有一个选项(a,c,s)指定返回的类型是atom，list还是strings of characters</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">w</span><span class="p">[</span><span class="n">the</span> <span class="n">c</span><span class="c1">#{&#39;a&#39;}t sat on the mat]a</span>
<span class="p">[</span><span class="ss">:the</span><span class="p">,</span> <span class="ss">:cat</span><span class="p">,</span> <span class="ss">:sat</span><span class="p">,</span> <span class="ss">:on</span><span class="p">,</span> <span class="ss">:the</span><span class="p">,</span> <span class="ss">:mat</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">w</span><span class="p">[</span><span class="n">the</span> <span class="n">c</span><span class="c1">#{&#39;a&#39;}t sat on the mat]c</span>
<span class="p">[</span><span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;cat&#39;</span><span class="p">,</span> <span class="s1">&#39;sat&#39;</span><span class="p">,</span> <span class="s1">&#39;on&#39;</span><span class="p">,</span> <span class="s1">&#39;the&#39;</span><span class="p">,</span> <span class="s1">&#39;mat&#39;</span><span class="p">]</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="err">~</span><span class="n">w</span><span class="p">[</span><span class="n">the</span> <span class="n">c</span><span class="c1">#{&#39;a&#39;}t sat on the mat]s</span>
<span class="p">[</span><span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">cat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">sat&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">on&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">the&quot;</span><span class="p">,</span> <span class="sd">&quot;</span><span class="s2">mat&quot;</span><span class="p">]</span>
</pre>
<h3>Single Quoted Strings</h3>

<p>单引号只是字符代码的列表</p>
<pre class="highlight elixir"><span class="n">iex</span><span class="o">&gt;</span> <span class="p">[</span> <span class="m">67</span><span class="p">,</span> <span class="m">65</span><span class="p">,</span> <span class="m">84</span> <span class="p">]</span>
<span class="s1">&#39;CAT&#39;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;olé&#39;</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;olé&#39;</span>
<span class="s1">&#39;olé&#39;</span>
<span class="c1"># The ~w in the format string forces str to be written as </span>
<span class="c1"># an Erlang term—the underlying list of integers. The ~n is a newline.</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="ss">:io</span><span class="o">.</span><span class="n">format</span> <span class="sd">&quot;</span><span class="s2">~w~n&quot;</span><span class="p">,</span> <span class="p">[</span> <span class="n">str</span> <span class="p">]</span>
<span class="p">[</span><span class="m">111</span><span class="p">,</span><span class="m">108</span><span class="p">,</span><span class="m">233</span><span class="p">]</span>
<span class="ss">:ok</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">list_to_tuple</span> <span class="n">str</span>
<span class="p">{</span><span class="m">111</span><span class="p">,</span> <span class="m">108</span><span class="p">,</span> <span class="m">233</span><span class="p">}</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="n">str</span> <span class="o">++</span> <span class="p">[</span><span class="m">0</span><span class="p">]</span>
<span class="p">[</span><span class="m">111</span><span class="p">,</span> <span class="m">108</span><span class="p">,</span> <span class="m">233</span><span class="p">,</span> <span class="m">0</span><span class="p">]</span>

</pre>
<p>?c 返回某个字符的代码</p>

<p>parse数字的例子</p>
<pre class="highlight elixir"><span class="k">defmodule</span> <span class="no">Parse</span> <span class="k">do
  def</span> <span class="n">number</span><span class="p">([</span> <span class="sx">?-</span> <span class="o">|</span> <span class="n">tail</span> <span class="p">]),</span> <span class="k">do</span><span class="p">:</span> <span class="n">_number_digits</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span> <span class="o">*</span> <span class="o">-</span><span class="m">1</span>
  <span class="k">def</span> <span class="n">number</span><span class="p">([</span> <span class="sx">?+</span> <span class="o">|</span> <span class="n">tail</span> <span class="p">]),</span> <span class="k">do</span><span class="p">:</span> <span class="n">_number_digits</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
  <span class="k">def</span> <span class="n">number</span><span class="p">(</span><span class="n">str</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">_number_digits</span><span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="m">0</span><span class="p">)</span>
  <span class="k">defp</span> <span class="n">_number_digits</span><span class="p">([],</span> <span class="n">value</span><span class="p">),</span> <span class="k">do</span><span class="p">:</span> <span class="n">value</span>
  <span class="k">defp</span> <span class="n">_number_digits</span><span class="p">([</span> <span class="n">digit</span> <span class="o">|</span> <span class="n">tail</span> <span class="p">],</span> <span class="n">value</span><span class="p">)</span>
  <span class="ow">when</span> <span class="n">digit</span> <span class="ow">in</span> <span class="s1">&#39;0123456789&#39;</span> <span class="k">do
    </span><span class="n">_number_digits</span><span class="p">(</span><span class="n">tail</span><span class="p">,</span> <span class="n">value</span><span class="o">*</span><span class="m">10</span> <span class="o">+</span> <span class="n">digit</span> <span class="o">-</span> <span class="sx">?0</span><span class="p">)</span>
  <span class="k">end</span>
  <span class="k">defp</span> <span class="n">_number_digits</span><span class="p">([</span> <span class="n">non_digit</span> <span class="o">|</span> <span class="n">_</span> <span class="p">],</span> <span class="n">_</span><span class="p">)</span> <span class="k">do
    raise</span> <span class="sd">&quot;</span><span class="s2">Invalid digit &#39;</span><span class="si">#{</span><span class="p">[</span><span class="n">non_digit</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Parse</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="s1">&#39;123&#39;</span><span class="p">)</span>
<span class="m">123</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Parse</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="s1">&#39;-123&#39;</span><span class="p">)</span>
<span class="o">-</span><span class="m">123</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Parse</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="s1">&#39;+123&#39;</span><span class="p">)</span>
<span class="m">123</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Parse</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="s1">&#39;+9&#39;</span><span class="p">)</span>
<span class="m">9</span>
<span class="n">iex</span><span class="o">&gt;</span> <span class="no">Parse</span><span class="o">.</span><span class="n">number</span><span class="p">(</span><span class="s1">&#39;+a&#39;</span><span class="p">)</span>
<span class="o">**</span> <span class="p">(</span><span class="no">RuntimeError</span><span class="p">)</span> <span class="no">Invalid</span> <span class="n">digit</span> <span class="s1">&#39;a&#39;</span>
</pre>
<h3>Double Quoted Strings</h3>

<p>双引号string保存在UTF-8 encoding的序列里,这暗示了2点</p>

<ol>
<li>binary的长度可能比实际长</li>
<li>因为不是list，所以要同时用binary syntax和list syntax</li>
</ol>

<p><a href="http://elixir-lang.org/docs/stable/elixir/String.html">String module API</a></p>

<h3>Binaries and Pattern Matching</h3>

<p><a name="control_flow"></a></p>

<h2>Control Flow</h2>

<ol>
<li>if and unless</li>
<li>cond</li>
<li>case</li>
<li>Raising Exceptions</li>
<li>Designing With Exceptions</li>
</ol>

<p>Elixr程序不需要太多分支语句也可以很有表现力。</p>

<p><a name="organizing_a_project"></a></p>

<h2>Organizing a Project</h2>

</article>
<div id="disqus_thread"></div>
            <script type="text/javascript">
            //<![CDATA[
                (function() {
                    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                    dsq.src = '//zyncrochinadevblog.disqus.com/embed.js';
                    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            //]]>
            </script>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </script>

</div>
</div>
</section>
<footer>
<script type="text/javascript">
//<![CDATA[
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44086232-1', 'zyncro-china.com');
  ga('send', 'pageview');
//]]>
</script>
</footer>
</body>
</html>

